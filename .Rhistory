arrange(desc(beneficiaries)) %>%
top_n(5) %>%
mutate(partner_code = fct_reorder(partner_code, beneficiaries)) %>%
ggplot(aes(x = mean_usd, y = partner_code, fill = beneficiaries)) +
scale_x_continuous(labels = comma_format(accuracy = 1)) +
scale_fill_viridis(option = "mako", direction = -1, begin = 0.2) +
geom_col() +
geom_text(aes(label = dollar(mean_usd)), size = 2, hjust = "inward") +
theme(axis.text.y = element_text(size = 7)) +
labs(x = "Average USD value of package per transfer",
y = "",
title = paste0({{name}})) +
theme(legend.title = element_text(size = 3),
legend.text = element_text(size = 3))
}
fsc %>% partner_mean_usd("food distribution") +
fsc %>% partner_mean_usd("food_cash for work_assets") +
fsc %>% partner_mean_usd("multi-purpose cash transfer") +
fsc %>% partner_mean_usd("IGA and small grants")
partner_mean_usd <- function(tbl, name){
tbl %>%
filter(!is.na(new_beneficiaries) & !is.na(usd_per_hhd)) %>%
filter(delivery_modality %in% c("CBT/CVA", "Hybrid (In-kind & CBT/CVA)")) %>%
filter(activity_red == {{name}}) %>%
mutate(reached_households = ifelse(activity_red == "food distribution",
reached_beneficiaries,
reached_households)) %>%
group_by(partner_code) %>%
summarise(total_value_usd = sum(total_value_usd),
beneficiaries = sum(new_beneficiaries),
households = sum(reached_households)) %>%
mutate(mean_usd = total_value_usd / households) %>%
arrange(desc(beneficiaries)) %>%
top_n(5) %>%
mutate(partner_code = fct_reorder(partner_code, beneficiaries)) %>%
ggplot(aes(x = mean_usd, y = partner_code, fill = beneficiaries)) +
scale_x_continuous(labels = comma_format(accuracy = 1)) +
scale_fill_viridis(option = "mako", direction = -1, begin = 0.2) +
geom_col() +
geom_text(aes(label = dollar(mean_usd)), size = 2, hjust = "inward") +
theme(axis.text.y = element_text(size = 7)) +
labs(x = "Average USD value of package per transfer",
y = "",
title = paste0(str_to_title({{name}}))) +
theme(legend.title = element_text(size = 3),
legend.text = element_text(size = 3))
}
fsc %>% partner_mean_usd("food distribution") +
fsc %>% partner_mean_usd("food_cash for work_assets") +
fsc %>% partner_mean_usd("multi-purpose cash transfer") +
fsc %>% partner_mean_usd("IGA and small grants")
fsc %>% partner_mean_usd("multi-purpose cash transfer") +
labs(title = "Multi-purpose cash transfer") +
fsc %>% partner_mean_usd("IGA and small grants") +
labs(title = "IGA and small grants")
fsc %>% partner_mean_usd("food distribution") +
labs(title = "Food distributions") +
fsc %>% partner_mean_usd("food_cash for work_assets") +
labs(title = "Food/cash for work/assets") +
fsc %>% partner_mean_usd("multi-purpose cash transfer") +
labs(title = "Multi-purpose cash transfer") +
fsc %>% partner_mean_usd("IGA and small grants") +
labs(title = "IGA and small grants")
fsc %>% count(activity_red)
cbt_bins <- fsc %>% filter(activity_red %in% c("food distribution", "multi-purpose cash transfer") &
!is.na(usd_per_hhd) &
!is.na(new_beneficiaries)) %>%
count(usd_hhd_bin, wt = reached_households) %>%
mutate(pc_of_total = round(n / sum(n) * 100, digits = 2))
fsc %>%
filter(activity_red %in% c("food distribution", "multi-purpose cash transfer") &
!is.na(usd_per_hhd) &
!is.na(new_beneficiaries)) %>%
mutate(pc_meb = usd_per_hhd / 114.55) %>%
group_by(usd_hhd_bin) %>%
summarise(avg_pc_of_meb = round(median(pc_meb) * 100, digits = 2),
avg_usd_month = round(median(usd_per_hhd, na.rm = TRUE), digits = 2),
households = round(sum(households))) %>%
mutate(pc_of_hhd = round(households / sum(households) * 100, digits = 2)) %>%
kable(caption = "Monthly cash-based transfer values by percentage of MEB received", format.args = list(big.mark = ",")) %>%
kable_classic_2("striped") %>%
column_spec(5, color = "white", background = spec_color(cbt_bins$pc_of_total[1:11], end = 0.9, direction = -1)) %>%
footnote(general = "Only households reached through monthly cash-based transfers are included",
general_title = "")
fsc %>%
filter(activity_red %in% c("food distribution", "multi-purpose cash transfer") &
!is.na(usd_per_hhd) &
!is.na(new_beneficiaries)) %>%
mutate(pc_meb = usd_per_hhd / 114.55) %>%
group_by(usd_hhd_bin) %>%
summarise(avg_pc_of_meb = round(median(pc_meb) * 100, digits = 2),
avg_usd_month = round(median(usd_per_hhd, na.rm = TRUE), digits = 2),
households = round(sum(reached_households))) %>%
mutate(pc_of_hhd = round(households / sum(households) * 100, digits = 2)) %>%
kable(caption = "Monthly cash-based transfer values by percentage of MEB received", format.args = list(big.mark = ",")) %>%
kable_classic_2("striped") %>%
column_spec(5, color = "white", background = spec_color(cbt_bins$pc_of_total[1:11], end = 0.9, direction = -1)) %>%
footnote(general = "Only households reached through monthly cash-based transfers are included",
general_title = "")
fsc %>% filter(activity_red == "food distribution" & !is.na(usd_per_hhd)) %>%
ggplot(aes(x = usd_per_hhd)) +
geom_histogram()
fsc %>% filter(activity_red == "food distribution" & !is.na(usd_per_hhd)) %>%
ggplot(aes(x = usd_per_hhd, y = new_beneficiaries)) +
geom_col()
fsc %>% filter(activity_red == "food distribution" & !is.na(usd_per_hhd)) %>%
ggplot(aes(x = usd_per_hhd, y = new_beneficiaries)) +
geom_point()
fsc %>% filter(activity_red == "food distribution" & !is.na(usd_per_hhd)) %>%
ggplot(aes(x = usd_per_hhd, y = new_beneficiaries)) +
geom_point() +
scale_x_log10()
fsc %>% filter(activity_red == "food distribution" & !is.na(usd_per_hhd)) %>%
ggplot(aes(x = usd_per_person, y = new_beneficiaries)) +
geom_point() +
scale_x_log10()
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 40000, by = 5000))
fsc %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 40000, by = 5000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of cash transfer per household per month",
y = "Number of households",
title = "Number of households by value of cash transfer per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households\nOnly households reached through the cash, hybrid or voucher modalities are included")
fsc %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 70000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of cash transfer per household per month",
y = "Number of households",
title = "Number of households by value of cash transfer per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households\nOnly households reached through the cash, hybrid or voucher modalities are included")
fsc %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of cash transfer per household per month",
y = "Number of households",
title = "Number of households by value of cash transfer per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households\nOnly households reached through the cash, hybrid or voucher modalities are included")
fsc %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
filter(delivery_modality %in% c("CBT/CVA", "Hybrid (In-kind & CBT/CVA)")) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of cash transfer per household per month",
y = "Number of households",
title = "Number of households by value of cash transfer per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households\nOnly households reached through the cash, hybrid or voucher modalities are included")
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 5000))
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000))
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(households = sum(reached_households)) %>%
mutate(`%_of_hhd` = round(households / sum(households) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = households, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of food distributions per month",
y = "Number of households",
title = "USD value of food distributions per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households")
fsd %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_new == "food distribution") %>%
group_by(state) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries)
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_new == "food distribution") %>%
group_by(state) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries) %>%
arrange(desc(mean_usd))
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
group_by(state) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries) %>%
arrange(desc(mean_usd))
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
group_by(state) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd),
mode = mode(usd_per_hhd),
min = min(usd_per_hhd),
max = max(usd_per_hhd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries) %>%
arrange(desc(mean_usd))
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state = "Kayah") %>%
ggplot(aes(x = usd_per_hhd)) +
geom_histogram()
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state == "Kayah") %>%
ggplot(aes(x = usd_per_hhd)) +
geom_histogram()
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state == "Kayin") %>%
ggplot(aes(x = usd_per_hhd)) +
geom_histogram()
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state == "Kayin")
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state == "Kaah") %>%
ggplot(aes(x = usd_per_hhd)) +
geom_histogram()
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
filter(state == "Kayah")
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
group_by(org_code) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd),
rows = n(),
mode = mode(usd_per_hhd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries) %>%
arrange(mean_usd)
fsc %>%
filter(!is.na(new_beneficiaries) & !is.na(total_value_usd) &
activity_red == "food distribution") %>%
group_by(partner_code) %>%
summarise(beneficiaries = sum(new_beneficiaries),
total_value_usd = sum(total_value_usd),
rows = n(),
mode = mode(usd_per_hhd)) %>%
mutate(mean_usd = total_value_usd / beneficiaries) %>%
arrange(mean_usd)
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(beneficiaries = sum(reached_beneficiaries)) %>%
mutate(`%_of_ben` = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = beneficiaries, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_hhd`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of food distributions per month",
y = "Number of households",
title = "USD value of food distributions per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households")
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(beneficiaries = sum(reached_beneficiaries)) %>%
mutate(`%_of_ben` = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = beneficiaries, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_ben`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 80000, by = 10000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of food distributions per month",
y = "Number of households",
title = "USD value of food distributions per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households")
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
group_by(usd_hhd_bin) %>%
summarise(beneficiaries = sum(reached_beneficiaries)) %>%
mutate(`%_of_ben` = round(beneficiaries / sum(beneficiaries) * 100, digits = 2)) %>%
ggplot(aes(x = usd_hhd_bin, y = beneficiaries, fill = usd_hhd_bin)) +
geom_col() +
geom_text(aes(label = `%_of_ben`), vjust = -0.4, size = 3) +
scale_fill_viridis_d(option = "mako", direction = -1) +
scale_y_continuous(labels = comma, breaks = seq(0, 160000, by = 20000)) +
theme(legend.position = "none",
axis.text.x = element_text(angle = 30, hjust = 0.8, vjust = 0.9)) +
labs(x = "USD value of food distributions per month",
y = "Number of households",
title = "USD value of food distributions per household (2022 1Q)",
subtitle = "Figures at the top of each bar show percentage of households")
fsc %>%
filter(activity_red == "food distribution") %>%
filter(!is.na(usd_per_hhd) & !is.na(new_beneficiaries)) %>%
ggplot(aes(x = usd_per_person)) +
geom_histogram()
fsc %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_)) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_)) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_)) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_),
usd_hhd_bin = fct_relevel(usd_hhd_bin, c("<$2", ">=$2_<$4", ">=$4_<$6", ">=$6_<$8", ">=$8_<$10",">=$10_<$12",
">=$12_<$14", ">=$14_<$16", ">=$16_<$18", ">=$18_<$20",">=20"))) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_),
usd_hhd_bin = fct_relevel(usd_person_bin, c("<$2", ">=$2_<$4", ">=$4_<$6", ">=$6_<$8", ">=$8_<$10",">=$10_<$12",
">=$12_<$14", ">=$14_<$16", ">=$16_<$18", ">=$18_<$20",">=20"))) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_),
usd_person_bin = fct_relevel(usd_person_bin, c("<$2", ">=$2_<$4", ">=$4_<$6", ">=$6_<$8", ">=$8_<$10",">=$10_<$12",
">=$12_<$14", ">=$14_<$16", ">=$16_<$18", ">=$18_<$20",">=20"))) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col()
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_),
usd_person_bin = fct_relevel(usd_person_bin, c("<$2", ">=$2_<$4", ">=$4_<$6", ">=$6_<$8", ">=$8_<$10",">=$10_<$12",
">=$12_<$14", ">=$14_<$16", ">=$16_<$18", ">=$18_<$20",">=20"))) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col() +
scale_x_continuous(breaks = seq(0, 150000, by = 10000))
fsc %>%
filter(!is.na(total_value_usd)) %>%
mutate(usd_person_bin = case_when(usd_per_person < 2 ~ "<$2",
usd_per_person >= 2 & usd_per_person < 4 ~ ">=$2_<$4",
usd_per_person >= 4 & usd_per_person < 6 ~ ">=$4_<$6",
usd_per_person >= 6 & usd_per_person < 8 ~ ">=$6_<$8",
usd_per_person >= 8 & usd_per_person < 10 ~ ">=$8_<$10",
usd_per_person >= 10 & usd_per_person < 12 ~ ">=$10_<$12",
usd_per_person >= 12 & usd_per_person < 14 ~ ">=$12_<$14",
usd_per_person >= 14 & usd_per_person < 16 ~ ">=$14_<$16",
usd_per_person >= 16 & usd_per_person < 18 ~ ">=$16_<$18",
usd_per_person >= 18 & usd_per_person < 20 ~ ">=$18_<$20",
usd_per_person >= 20 ~ ">=$20",
TRUE ~ NA_character_),
usd_person_bin = fct_relevel(usd_person_bin, c("<$2", ">=$2_<$4", ">=$4_<$6", ">=$6_<$8", ">=$8_<$10",">=$10_<$12",
">=$12_<$14", ">=$14_<$16", ">=$16_<$18", ">=$18_<$20",">=20"))) %>%
ggplot(aes(x = new_beneficiaries, y = usd_person_bin)) +
geom_col() +
scale_x_continuous(breaks = seq(0, 140000, by = 20000))
